

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>molmodmt.protonation &mdash; MolModMT 0.1 documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="../../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
        <script type="text/javascript" src="../../_static/jquery.js"></script>
        <script type="text/javascript" src="../../_static/underscore.js"></script>
        <script type="text/javascript" src="../../_static/doctools.js"></script>
        <script type="text/javascript" src="../../_static/language_data.js"></script>
    
    <script type="text/javascript" src="../../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../index.html" class="icon icon-home"> MolModMT
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../../Installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../Quickstart.html">First tasks easily done with MolModMT</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../Quickstart.html#Fetching-molecular-systems-from-web-databases">Fetching molecular systems from web databases</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Quickstart.html#Loading-molecular-systems-and-trajectories">Loading molecular systems and trajectories</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Quickstart.html#Converting-molecular-systems-and-trajectories">Converting molecular systems and trajectories</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Quickstart.html#Working-with-id-codes">Working with id codes</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Quickstart.html#Working-with-sequences">Working with sequences</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Quickstart.html#Writting-molecular-systems-or-trajectories-as-files">Writting molecular systems or trajectories as files</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Quickstart.html#Atoms-selection">Atoms selection</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Quickstart.html#Viewing-molecular-systems-and-trajectories">Viewing molecular systems and trajectories</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Quickstart.html#Molecular-systems-as-MolModMT’s-forms">Molecular systems as MolModMT’s forms</a></li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../api/index.html">API Documentation</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../api/index.html#basic-manipulations">Basic manipulations</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../api/_autosummary/molmodmt.load.html">molmodmt.load</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../api/_autosummary/molmodmt.get_form.html">molmodmt.get_form</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../api/_autosummary/molmodmt.get.html">molmodmt.get</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../api/_autosummary/molmodmt.set.html">molmodmt.set</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../api/_autosummary/molmodmt.info.html">molmodmt.info</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../api/_autosummary/molmodmt.select.html">molmodmt.select</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../api/_autosummary/molmodmt.convert.html">molmodmt.convert</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../api/_autosummary/molmodmt.extract.html">molmodmt.extract</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../api/_autosummary/molmodmt.merge.html">molmodmt.merge</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../api/_autosummary/molmodmt.write.html">molmodmt.write</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../api/_autosummary/molmodmt.view.html">molmodmt.view</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../api/index.html#transformations">Transformations</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../api/_autosummary/molmodmt.set.html">molmodmt.set</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../api/_autosummary/molmodmt.remove.html">molmodmt.remove</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../api/_autosummary/molmodmt.remove_solvent.html">molmodmt.remove_solvent</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../api/_autosummary/molmodmt.add_missing_hydrogens.html">molmodmt.add_missing_hydrogens</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../api/_autosummary/molmodmt.recenter.html">molmodmt.recenter</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../api/_autosummary/molmodmt.fix_chains.html">molmodmt.fix_chains</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../api/_autosummary/molmodmt.fix_pdb_structure.html">molmodmt.fix_pdb_structure</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../api/_autosummary/molmodmt.add_loop.html">molmodmt.add_loop</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../api/index.html#observables">Observables</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../api/_autosummary/molmodmt.get.html">molmodmt.get</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../api/_autosummary/molmodmt.distances.html">molmodmt.distances</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../api/_autosummary/molmodmt.contact_map.html">molmodmt.contact_map</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../api/_autosummary/molmodmt.neighbors_lists.html">molmodmt.neighbors_lists</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../api/_autosummary/molmodmt.center_of_mass.html">molmodmt.center_of_mass</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../api/_autosummary/molmodmt.geometrical_center.html">molmodmt.geometrical_center</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../api/_autosummary/molmodmt.radius_of_gyration.html">molmodmt.radius_of_gyration</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../api/index.html#comparisons">Comparisons</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../api/_autosummary/molmodmt.rmsd.html">molmodmt.rmsd</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../api/_autosummary/molmodmt.least_rmsd_fit.html">molmodmt.least_rmsd_fit</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../api/_autosummary/molmodmt.sequence_identity.html">molmodmt.sequence_identity</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../api/_autosummary/molmodmt.sequence_alignment.html">molmodmt.sequence_alignment</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../api/_autosummary/molmodmt.structure_alignment.html">molmodmt.structure_alignment</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../api/index.html#modeling">Modeling</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../api/_autosummary/molmodmt.add_loop.html">molmodmt.add_loop</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../api/index.html#glossary">Glossary</a></li>
</ul>
</li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">MolModMT</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../index.html">Docs</a> &raquo;</li>
        
          <li><a href="../index.html">Module code</a> &raquo;</li>
        
      <li>molmodmt.protonation</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <h1>Source code for molmodmt.protonation</h1><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">.utils.exceptions</span> <span class="k">import</span> <span class="o">*</span>

<div class="viewcode-block" id="add_missing_hydrogens"><a class="viewcode-back" href="../../api/_autosummary/molmodmt.add_missing_hydrogens.html#molmodmt.add_missing_hydrogens">[docs]</a><span class="k">def</span> <span class="nf">add_missing_hydrogens</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="n">pH</span><span class="o">=</span><span class="mf">7.4</span><span class="p">,</span> <span class="n">forcefield</span><span class="o">=</span><span class="s1">&#39;AMBER99SB-ILDN&#39;</span><span class="p">,</span> <span class="n">engine</span><span class="o">=</span><span class="s1">&#39;OpenMM&#39;</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>

    <span class="sd">&quot;&quot;&quot;add_missing_hydrogens(item, pH=7.4, forcefield=&#39;AMBER99SB-ILDN&#39;, engine=&#39;OpenMM&#39;, verbose=False)</span>

<span class="sd">    The missing hydrogens of a molecular model are added. This method does not remove any hydrogen</span>
<span class="sd">    already present.</span>

<span class="sd">    Regarding the protonation states of the aminoacids the documentation corresponding to the</span>
<span class="sd">    chosen engine should be checked for further details.</span>

<span class="sd">    - OpenMM: The protonation state is determined according the frequency of the variant at the specified pH, and the participation of Cysteines in disulfide bonds or Histidines in hydrogen bonds. This engine needs the specification of a forcefield. See the `OpenMM User Manual &lt;http://docs.openmm.org/7.0.0/userguide/application.html#adding-hydrogens&gt;`_ or the `OpenMM Api Guide &lt;http://docs.openmm.org/development/api-python/generated/simtk.openmm.app.modeller.Modeller.html#simtk.openmm.app.modeller.Modeller.addHydrogens&gt;`_.</span>

<span class="sd">    - PDBFixer: The protonation state is determined according to the frequency of the variant at the specified pH. See the `PDBFixer Manual &lt;http://htmlpreview.github.io/?https://raw.github.com/pandegroup/pdbfixer/master/Manual.html&gt;`_.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>

<span class="sd">    item: Molecular model in accepted form.</span>
<span class="sd">        Molecular model in any of the accepted forms by MolModMT.</span>
<span class="sd">    pH: float, default: 7.4</span>
<span class="sd">        The pH based on which to determine the aminoacids protonation states.</span>
<span class="sd">    forcefield: str, default: &#39;AMBER99SB-ILDN&#39;</span>
<span class="sd">        Name of the forcefield to be used by OpenMM ([check the list of names accepted here]())</span>
<span class="sd">    engine: str (&#39;OpenMM&#39; or &#39;PDBFixer&#39;), default: &#39;OpenMM&#39;</span>
<span class="sd">        Name of the engine used to add the missing hydrogens. The following options are available:</span>
<span class="sd">            - &#39;OpenMM&#39;: The method openmm.app.modeller.Modeller.addHydrogens is included in the</span>
<span class="sd">              workflow. See the `OpenMM User Manual</span>
<span class="sd">              &lt;http://docs.openmm.org/7.0.0/userguide/application.html#adding-hydrogens&gt;`_ or the</span>
<span class="sd">              `OpenMM Api Guide</span>
<span class="sd">              &lt;http://docs.openmm.org/development/api-python/generated/simtk.openmm.app.modeller.Modeller.html#simtk.openmm.app.modeller.Modeller.addHydrogens&gt;`_.</span>
<span class="sd">            - &#39;PDBFixer&#39;: The method pdbfixer.PDBFixer.addMissingHydrogens() is included in the workflow. See the `PDBFixer Manual &lt;http://htmlpreview.github.io/?https://raw.github.com/pandegroup/pdbfixer/master/Manual.html&gt;`_.</span>
<span class="sd">    verbose: bool, default: False</span>
<span class="sd">        The method prints out useful information if verbose=`True`.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    item : Molecular model in the same form as input `item`.</span>
<span class="sd">        A new molecular model with the missing hydrogens</span>
<span class="sd">        added is returned. The form will be the same as the input model.</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>

<span class="sd">    See Also</span>
<span class="sd">    --------</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    &quot;&quot;&quot;</span>


    <span class="kn">from</span> <span class="nn">.multitool</span> <span class="k">import</span> <span class="n">convert</span>
    <span class="kn">from</span> <span class="nn">.utils.forms</span> <span class="k">import</span> <span class="n">digest</span> <span class="k">as</span> <span class="n">digest_forms</span>
    <span class="kn">from</span> <span class="nn">.utils.engines</span> <span class="k">import</span> <span class="n">digest</span> <span class="k">as</span> <span class="n">digest_engines</span>

    <span class="n">form_in</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">digest_forms</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
    <span class="n">engine</span> <span class="o">=</span> <span class="n">digest_engines</span><span class="p">(</span><span class="n">engine</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">engine</span><span class="o">==</span><span class="s2">&quot;OpenMM&quot;</span><span class="p">:</span>

        <span class="n">tmp_item</span> <span class="o">=</span> <span class="n">convert</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="s2">&quot;openmm.Modeller&quot;</span><span class="p">)</span>
        <span class="n">log_residues_changed</span> <span class="o">=</span> <span class="n">tmp_item</span><span class="o">.</span><span class="n">addHydrogens</span><span class="p">(</span><span class="n">pH</span><span class="o">=</span><span class="n">pH</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Missing hydrogens added.&#39;</span><span class="p">)</span>
            <span class="n">ii</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="k">for</span> <span class="n">residue</span> <span class="ow">in</span> <span class="n">item</span><span class="o">.</span><span class="n">topology</span><span class="o">.</span><span class="n">residues</span><span class="p">():</span>
                <span class="k">if</span> <span class="n">log_residues_changed</span><span class="p">[</span><span class="n">ii</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1">-</span><span class="si">{}</span><span class="s1"> to </span><span class="si">{}</span><span class="s1">-</span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">residue</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">residue</span><span class="o">.</span><span class="n">index</span><span class="p">,</span>
                                                   <span class="n">log_residues_changed</span><span class="p">[</span><span class="n">ii</span><span class="p">],</span> <span class="n">residue</span><span class="o">.</span><span class="n">index</span><span class="p">))</span>
                <span class="n">ii</span><span class="o">+=</span><span class="mi">1</span>

    <span class="k">elif</span> <span class="n">engine</span><span class="o">==</span><span class="s1">&#39;PDBFixer&#39;</span><span class="p">:</span>

        <span class="n">tmp_item</span> <span class="o">=</span> <span class="n">convert</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="s2">&quot;pdbfixer.PDBFixer&quot;</span><span class="p">)</span>
        <span class="n">tmp_item</span><span class="o">.</span><span class="n">addMissingHydrogens</span><span class="p">(</span><span class="n">pH</span><span class="o">=</span><span class="n">pH</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Missing hydrogens added (PDBFixer gives no details).&#39;</span><span class="p">)</span>

    <span class="k">else</span><span class="p">:</span>

        <span class="k">raise</span> <span class="ne">NotImplementedError</span>

    <span class="n">tmp_item</span> <span class="o">=</span> <span class="n">convert</span><span class="p">(</span><span class="n">tmp_item</span><span class="p">,</span> <span class="n">form_in</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">tmp_item</span></div>

<span class="k">def</span> <span class="nf">redefine_protonation_states</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="n">pH</span><span class="o">=</span><span class="mf">7.4</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>

    <span class="k">raise</span> <span class="ne">NotImplementedError</span>
    <span class="k">pass</span>

</pre></div>

           </div>
           
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2018, UIBCDF Lab at the Mexico City Childrens Hospital Federico Gomez and authors

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>